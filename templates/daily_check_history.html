{% extends "base.html" %}
{% block content %}

<div class="container mt-4">
  <h4 class="mb-3">üìã ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</h4>

  <!-- ‡∏Å‡∏£‡∏≤‡∏ü‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ -->
  <div class="text-center mb-4">
    <div style="max-width: 400px; margin: auto;">
      <canvas id="statusChart"></canvas>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    const ctx = document.getElementById('statusChart');
    const normalCount = {{ normal_count|default(0) }};
    const errorCount = {{ error_count|default(0) }};
    const pendingCount = {{ pending_count|default(0) }};

    new Chart(ctx, {
      type: 'doughnut',
      data: {
        labels: ['‡∏õ‡∏Å‡∏ï‡∏¥', '‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥', '‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö'],
        datasets: [{
          data: [normalCount, errorCount, pendingCount],
          backgroundColor: ['#4caf50', '#f44336', '#ff9800']
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { position: 'bottom' },
          title: { display: true, text: '‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö' }
        }
      }
    });
  </script>

  <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
  <div class="table-responsive mt-4">
    <table class="table table-striped align-middle">
      <thead class="table-primary">
        <tr>
          <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</th>
          <th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</th>
          <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
          <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
          <th>‡∏ï‡∏£‡∏ß‡∏à‡πÇ‡∏î‡∏¢</th>
        </tr>
      </thead>
      <tbody>
        {% for c in checks %}
        <tr>
          <td>{{ c.check_date }}</td>
          <td>{{ c.item_name }}</td>
          <td>
            {% if c.status == '‡∏õ‡∏Å‡∏ï‡∏¥' %}
              <span class="badge bg-success">{{ c.status }}</span>
            {% elif c.status == '‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥' %}
              <span class="badge bg-danger">{{ c.status }}</span>
            {% else %}
              <span class="badge bg-warning text-dark">{{ c.status }}</span>
            {% endif %}
          </td>
          <td>{{ c.remark or '-' }}</td>
          <td>{{ c.checked_by }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <div class="mt-3 text-end">
    <a href="{{ url_for('daily_check') }}" class="btn btn-secondary">‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</a>
  </div>
</div>

{% endblock %}
